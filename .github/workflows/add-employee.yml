name: Playwright Employee Onboarding Tests

on:
  workflow_dispatch:
    inputs:
      EMP_FIRST:
        description: 'Employee First Name'
        required: true
        default: 'John'
      EMP_LAST:
        description: 'Employee Last Name'
        required: true
        default: 'Doe'
      EMP_EMAIL:
        description: 'Employee Email'
        required: true
        default: 'john.doe@company.com'
      EMP_FATHER:
        description: "Father's Name"
        required: false
        default: 'Robert'
      EMP_PHONE:
        description: 'Phone Number'
        required: false
        default: '9876543210'

jobs:
  test:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 18
    
    - name: Install dependencies
      run: npm ci
    
    - name: Install Playwright Browsers
      run: npx playwright install --with-deps chromium
    
    - name: Run Playwright tests
      env:
        BASE_URL: https://kolors-dev.rnit.ai
        EMP_FIRST: ${{ github.event.inputs.EMP_FIRST }}
        EMP_LAST: ${{ github.event.inputs.EMP_LAST }}
        EMP_EMAIL: ${{ github.event.inputs.EMP_EMAIL }}
        EMP_FATHER: ${{ github.event.inputs.EMP_FATHER }}
        EMP_PHONE: ${{ github.event.inputs.EMP_PHONE }}
      run: npx playwright test tests/employee-onboard.spec.ts --project=chromium
    
    - name: Upload test results
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: playwright-report
        path: playwright-report/
        retention-days: 30
    
    - name: Upload test screenshots/videos
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: test-results
        path: test-results/
        retention-days: 30